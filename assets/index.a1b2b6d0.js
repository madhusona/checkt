var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,s=(t,l,r)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[l]=r,o=(e,t)=>{for(var l in t||(t={}))n.call(t,l)&&s(e,l,t[l]);if(r)for(var l of r(t))a.call(t,l)&&s(e,l,t[l]);return e},i=(e,r)=>t(e,l(r));import{f as c,r as u,R as m,a as d,B as h,L as p,S as g,b,c as E}from"./vendor.249c6195.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const l of e)if("childList"===l.type)for(const e of l.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();c.initializeApp({apiKey:"AIzaSyB2M247g4MruADB7ulqJA-vwxzMW4mQvRk",authDomain:"quiz-b5c85.firebaseapp.com",databaseURL:"https://quiz-b5c85.firebaseio.com",projectId:"quiz-b5c85",storageBucket:"quiz-b5c85.appspot.com",messagingSenderId:"43594244658",appId:"1:43594244658:web:91994d8917d30e49fd522b"});var f=c.database();const v=c.auth();c.firestore();const T=c.messaging(),y=new c.auth.GoogleAuthProvider;y.setCustomParameters({promt:"select_account"});const N=e=>T.getToken({vapidKey:"BIpqtQcexH8yrMpe7DE2MA_eJzVthxN-I-cFLoLl0HJqrq_2BEmoHO6Mbnm6NVtoZbkUIHL0xf2OV_1emyTpFAY"}).then((t=>{t?(console.log("current token for client: ",t),e(!0)):(console.log("No registration token available. Request permission to generate one."),e(!1))})).catch((e=>{console.log("An error occurred while retrieving token. ",e)})),x=()=>{v.signInWithPopup(y).then((e=>{console.log(e.user)})).catch((e=>{console.log(e.message)}))},C=f.ref("/tutorials");var k=new class{getAll(){return C}create(e){return C.push(e)}update(e,t){return C.child(e).update(t)}delete(e){return C.child(e).remove()}deleteAll(){return C.remove()}};const S=u.exports.createContext({user:null});var A=e=>{const[t,l]=u.exports.useState(null);return u.exports.useEffect((()=>{v.onAuthStateChanged((async e=>{const{displayName:t,email:r}=e;l({displayName:t,email:r})}))}),[]),m.createElement(S.Provider,{value:t},e.children)};function P(){const[e,t]=u.exports.useState(null),[l,r]=u.exports.useState(null);u.exports.useState(!1);const[n,a]=u.exports.useState(!1),s=u.exports.useContext(S),[o,i]=u.exports.useState(null);return u.exports.useEffect((()=>{s||i("/")}),[s]),o?m.createElement(d,{to:o}):m.createElement("div",{className:"submit-form"},n?m.createElement("div",null,m.createElement("h4",null,"You submitted successfully!"),m.createElement("button",{className:"btn btn-success",onClick:this.newTutorial},"Add")):m.createElement("form",{onSubmit:t=>{t.preventDefault();let r={title:e,description:l,published:n};console.log({Title:e}),k.create(r).then((()=>{console.log("Created new item successfully!"),a(True)})).catch((e=>{console.log(e)}))}},m.createElement("div",{className:"form-group"},m.createElement("label",{htmlFor:"title"},"Title"),m.createElement("input",{type:"text",className:"form-control",id:"title",required:!0,value:e,onChange:e=>t(e.target.value),name:"title"})),m.createElement("div",{className:"form-group"},m.createElement("label",{htmlFor:"description"},"Description"),m.createElement("input",{type:"text",className:"form-control",id:"description",required:!0,value:l,onChange:e=>r(e.target.value),name:"description"})),m.createElement("button",null,"Submit")))}class D extends u.exports.Component{constructor(e){super(e),this.onChangeTitle=this.onChangeTitle.bind(this),this.onChangeDescription=this.onChangeDescription.bind(this),this.updatePublished=this.updatePublished.bind(this),this.updateTutorial=this.updateTutorial.bind(this),this.deleteTutorial=this.deleteTutorial.bind(this),this.state={currentTutorial:{key:null,title:"",description:"",published:!1},message:""}}static getDerivedStateFromProps(e,t){const{tutorial:l}=e;return t.currentTutorial.key!==l.key?{currentTutorial:l,message:""}:t.currentTutorial}componentDidMount(){this.setState({currentTutorial:this.props.tutorial})}onChangeTitle(e){const t=e.target.value;this.setState((function(e){return{currentTutorial:i(o({},e.currentTutorial),{title:t})}}))}onChangeDescription(e){const t=e.target.value;this.setState((e=>({currentTutorial:i(o({},e.currentTutorial),{description:t})})))}updatePublished(e){k.update(this.state.currentTutorial.key,{published:e}).then((()=>{this.setState((t=>({currentTutorial:i(o({},t.currentTutorial),{published:e}),message:"The status was updated successfully!"})))})).catch((e=>{console.log(e)}))}updateTutorial(){const e={title:this.state.currentTutorial.title,description:this.state.currentTutorial.description};k.update(this.state.currentTutorial.key,e).then((()=>{this.setState({message:"The tutorial was updated successfully!"})})).catch((e=>{console.log(e)}))}deleteTutorial(){k.delete(this.state.currentTutorial.key).then((()=>{this.props.refreshList()})).catch((e=>{console.log(e)}))}render(){const{currentTutorial:e}=this.state;return m.createElement("div",null,m.createElement("h4",null,"Tutorial"),e?m.createElement("div",{className:"edit-form"},m.createElement("form",null,m.createElement("div",{className:"form-group"},m.createElement("label",{htmlFor:"title"},"Title"),m.createElement("input",{type:"text",className:"form-control",id:"title",value:e.title,onChange:this.onChangeTitle})),m.createElement("div",{className:"form-group"},m.createElement("label",{htmlFor:"description"},"Description"),m.createElement("input",{type:"text",className:"form-control",id:"description",value:e.description,onChange:this.onChangeDescription})),m.createElement("div",{className:"form-group"},m.createElement("label",null,m.createElement("strong",null,"Status:")),e.published?"Published":"Pending")),e.published?m.createElement("button",{className:"badge badge-primary mr-2",onClick:()=>this.updatePublished(!1)},"UnPublish"):m.createElement("button",{className:"badge badge-primary mr-2",onClick:()=>this.updatePublished(!0)},"Publish"),m.createElement("button",{className:"badge badge-danger mr-2",onClick:this.deleteTutorial},"Delete"),m.createElement("button",{type:"submit",className:"badge badge-success",onClick:this.updateTutorial},"Update"),m.createElement("p",null,this.state.message)):m.createElement("div",null,m.createElement("br",null),m.createElement("p",null,"Please click on a Tutorial...")))}}class w extends u.exports.Component{constructor(e){super(e),this.refreshList=this.refreshList.bind(this),this.setActiveTutorial=this.setActiveTutorial.bind(this),this.removeAllTutorials=this.removeAllTutorials.bind(this),this.onDataChange=this.onDataChange.bind(this),this.state={tutorials:[],currentTutorial:null,currentIndex:-1}}componentDidMount(){k.getAll().on("value",this.onDataChange)}componentWillUnmount(){k.getAll().off("value",this.onDataChange)}onDataChange(e){let t=[];e.forEach((e=>{let l=e.key,r=e.val();t.push({key:l,title:r.title,description:r.description,published:r.published})})),this.setState({tutorials:t})}refreshList(){this.setState({currentTutorial:null,currentIndex:-1})}setActiveTutorial(e,t){this.setState({currentTutorial:e,currentIndex:t})}removeAllTutorials(){k.deleteAll().then((()=>{this.refreshList()})).catch((e=>{console.log(e)}))}render(){const{tutorials:e,currentTutorial:t,currentIndex:l}=this.state;return m.createElement("div",{className:"list row"},m.createElement("div",{className:"col-md-6"},m.createElement("h4",null,"Tutorials List"),m.createElement("ul",{className:"list-group"},e&&e.map(((e,t)=>m.createElement("li",{className:"list-group-item "+(t===l?"active":""),onClick:()=>this.setActiveTutorial(e,t),key:t},e.title)))),m.createElement("button",{className:"m-3 btn btn-sm btn-danger",onClick:this.removeAllTutorials},"Remove All")),m.createElement("div",{className:"col-md-6"},t?m.createElement(D,{tutorial:t,refreshList:this.refreshList}):m.createElement("div",null,m.createElement("br",null),m.createElement("p",null,"Please click on a Tutorial..."))))}}function L(){const e=u.exports.useContext(S),[t,l]=u.exports.useState(null);return u.exports.useEffect((()=>{e&&l("/add")}),[e]),m.createElement("div",{className:"login-buttons"},m.createElement("button",{className:"login-provider-button",onClick:x},m.createElement("img",{src:"https://img.icons8.com/ios-filled/50/000000/google-logo.png",alt:"google icon"}),m.createElement("span",null," Continue with Google")))}function I(){const[e,t]=u.exports.useState(!1),[l,r]=u.exports.useState({title:"",body:""}),[n,a]=u.exports.useState(!1);return N(a),new Promise((e=>{T.onMessage((t=>{e(t)}))})).then((e=>{t(!0),r({title:e.notification.title,body:e.notification.body}),console.log(e)})).catch((e=>console.log("failed: ",e))),N(a),m.createElement(A,null,m.createElement(h,null,m.createElement("div",null,m.createElement("div",{onClose:()=>t(!1),show:e,delay:3e3,autohide:!0,animation:!0,style:{position:"absolute",top:20,right:20,minWidth:200}},m.createElement("div",null,m.createElement("img",{src:"holder.js/20x20?text=%20",className:"rounded mr-2",alt:""}),m.createElement("strong",{className:"mr-auto"},l.title),m.createElement("small",null,"just now")),m.createElement("div",null,l.body)),n&&m.createElement("h1",null," Notification permission enabled 👍🏻 "),!n&&m.createElement("h1",null," Need notification permission ❗️ "),m.createElement("div",{className:"navbar-nav mr-auto"},m.createElement("li",{className:"nav-item"},m.createElement(p,{to:"/tutorials",className:"nav-link"},"Tutorials")),m.createElement("li",{className:"nav-item"},m.createElement(p,{to:"/add",className:"nav-link"},"Add"))),m.createElement("div",{className:"container mt-3"},m.createElement("h2",null,"React Firebase Database CRUD"),m.createElement(g,null,m.createElement(b,{exact:!0,path:"/"},m.createElement(L,null)),m.createElement(b,{exact:!0,path:"/tutorials",component:w}),m.createElement(b,{exact:!0,path:"/add",component:P}))))))}E.render(m.createElement(I,null),document.getElementById("root"));
